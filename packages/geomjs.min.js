(function(){var e,t,n=[].slice;this.geomjs||(this.geomjs={}),e=function(){function e(e,t,n,r,i,s){var o;e==null&&(e=1),t==null&&(t=0),n==null&&(n=0),r==null&&(r=1),i==null&&(i=0),s==null&&(s=0),o=this.matrixFrom(e,t,n,r,i,s),this.a=o[0],this.b=o[1],this.c=o[2],this.d=o[3],this.tx=o[4],this.ty=o[5]}return e.DEG_TO_RAD=Math.PI/180,e.isMatrix=function(e){var t,n,r,i;if(e==null)return!1;i=["a","b","c","d","tx","ty"];for(n=0,r=i.length;n<r;n++){t=i[n];if(e[t]==null)return!1}return!0},e.prototype.translate=function(e,t){return e==null&&(e=0),t==null&&(t=0),this.tx+=e,this.ty+=t,this},e.prototype.scale=function(e,t){return e==null&&(e=1),t==null&&(t=1),this.a*=e,this.d*=t,this.tx*=e,this.ty*=t,this},e.prototype.rotate=function(e){var t,n,r;return e==null&&(e=0),t=Math.cos(e),n=Math.sin(e),r=[this.a*t-this.b*n,this.a*n+this.b*t,this.c*t-this.d*n,this.c*n+this.d*t,this.tx*t-this.ty*n,this.tx*n+this.ty*t],this.a=r[0],this.b=r[1],this.c=r[2],this.d=r[3],this.tx=r[4],this.ty=r[5],this},e.prototype.skew=function(t,n){var r;return t==null&&(t=0),n==null&&(n=0),r=[t*e.DEG_TO_RAD,n*e.DEG_TO_RAD],t=r[0],n=r[1],this.append(Math.cos(n),Math.sin(n),-Math.sin(t),Math.cos(t))},e.prototype.append=function(e,t,n,r,i,s){var o,u;return e==null&&(e=1),t==null&&(t=0),n==null&&(n=0),r==null&&(r=1),i==null&&(i=0),s==null&&(s=0),o=this.matrixFrom(e,t,n,r,i,s),e=o[0],t=o[1],n=o[2],r=o[3],i=o[4],s=o[5],u=[e*this.a+t*this.c,e*this.b+t*this.d,n*this.a+r*this.c,n*this.b+r*this.d,i*this.a+s*this.c+this.tx,i*this.b+s*this.d+this.ty],this.a=u[0],this.b=u[1],this.c=u[2],this.d=u[3],this.tx=u[4],this.ty=u[5],this},e.prototype.prepend=function(e,t,n,r,i,s){var o,u,a;e==null&&(e=1),t==null&&(t=0),n==null&&(n=0),r==null&&(r=1),i==null&&(i=0),s==null&&(s=0),o=this.matrixFrom(e,t,n,r,i,s),e=o[0],t=o[1],n=o[2],r=o[3],i=o[4],s=o[5];if(e!==1||t!==0||n!==0||r!==1)u=[this.a*e+this.b*n,this.a*t+this.b*r,this.c*e+this.d*n,this.c*t+this.d*r],this.a=u[0],this.b=u[1],this.c=u[2],this.d=u[3];return a=[this.tx*e+this.ty*n+i,this.tx*t+this.ty*r+s],this.tx=a[0],this.ty=a[1],this},e.prototype.identity=function(){var e;return e=[1,0,0,1,0,0],this.a=e[0],this.b=e[1],this.c=e[2],this.d=e[3],this.tx=e[4],this.ty=e[5],this},e.prototype.inverse=function(){var e,t;return e=this.a*this.d-this.b*this.c,t=[this.d/e,-this.b/e,-this.c/e,this.a/e,(this.c*this.ty-this.d*this.tx)/e,-(this.a*this.ty-this.b*this.tx)/e],this.a=t[0],this.b=t[1],this.c=t[2],this.d=t[3],this.tx=t[4],this.ty=t[5],this},e.prototype.asFloat=function(){var e,t,r,i,s;e=1<=arguments.length?n.call(arguments,0):[];for(t=i=0,s=e.length;i<s;t=++i)r=e[t],e[t]=parseFloat(r);return e},e.prototype.matrixFrom=function(e,t,n,r,i,s){var o;return this.isMatrix(e)?(o=e,e=o.a,t=o.b,n=o.c,r=o.d,i=o.tx,s=o.ty):this.isFloat(e,t,n,r,i,s)||this.invalidMatrixArguments([e,t,n,r,i,s]),this.asFloat(e,t,n,r,i,s)},e.prototype.isMatrix=function(t){return e.isMatrix(t)},e.prototype.isFloat=function(){var e,t,r,i;t=1<=arguments.length?n.call(arguments,0):[];for(r=0,i=t.length;r<i;r++){e=t[r];if(isNaN(parseFloat(e)))return!1}return!0},e.prototype.invalidMatrixArguments=function(e){throw new Error("Invalid arguments "+e+" for a Matrix")},e.prototype.clone=function(){return new e(this)},e.prototype.toString=function(){return"[object Matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty+")]"},e}(),t=function(){function e(e,t){var n,r;n=this.coordsFrom(e,t),e=n[0],t=n[1],r=this.defaultToZero(e,t),this.x=r[0],this.y=r[1]}return e.isPoint=function(e){return e!=null&&e.x!=null&&e.y!=null},e.isFloat=function(e){return!isNaN(parseFloat(e))},e.polar=function(t,n){return n==null&&(n=1),new e(Math.sin(t)*n,Math.cos(t)*n)},e.interpolate=function(){var t,n,r,i,s,o,u,a,f;t=[];for(r=a=0,f=arguments.length;a<f;r=++a)u=arguments[r],t[r]=u;return this.isPoint(t[0])?s=t.shift():this.isFloat(t[0])&&this.isFloat(t[1])?(s=new e(t[0],t[1]),t.splice(0,2)):this.pointNotFound(t,"first"),this.isPoint(t[0])?o=t.shift():this.isFloat(t[0])&&this.isFloat(t[1])?(o=new e(t[0],t[1]),t.splice(0,2)):this.pointNotFound(t,"second"),i=parseFloat(t.shift()),isNaN(i)&&this.missingPosition(i),n=o.subtract(s),new e(s.x+n.x*i,s.y+n.y*i)},e.missingPosition=function(e){throw new Error("Point.interpolate require a position but "+e+" was given")},e.pointNotFound=function(e,t){throw new Error("Can't find the "+t+" point in Point.interpolate arguments "+e)},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.normalize=function(t){var n;return t==null&&(t=1),isNaN(parseFloat(t))&&this.invalidLength(t),n=this.length(),new e(this.x/n*t,this.y/n*t)},e.prototype.add=function(t,n){var r,i;return r=this.coordsFrom(t,n),t=r[0],n=r[1],i=this.defaultToZero(t,n),t=i[0],n=i[1],new e(this.x+t,this.y+n)},e.prototype.subtract=function(t,n){var r,i;return r=this.coordsFrom(t,n),t=r[0],n=r[1],i=this.defaultToZero(t,n),t=i[0],n=i[1],new e(this.x-t,this.y-n)},e.prototype.dot=function(e,t){var n;return e==null&&t==null&&this.noPoint("dot"),n=this.coordsFrom(e,t,!0),e=n[0],t=n[1],this.x*e+this.y*t},e.prototype.distance=function(e,t){var n;return e==null&&t==null&&this.noPoint("dot"),n=this.coordsFrom(e,t,!0),e=n[0],t=n[1],this.subtract(e,t).length()},e.prototype.paste=function(e,t){var n;return n=this.coordsFrom(e,t),e=n[0],t=n[1],typeof e=="number"&&(this.x=e),typeof t=="number"&&(this.y=t),this},e.prototype.scale=function(t){return this.isFloat(t)||this.invalidScale(t),new e(this.x*t,this.y*t)},e.prototype.coordsFrom=function(e,t,n){var r;return n==null&&(n=!1),typeof e=="object"&&(n&&!this.isPoint(e)&&this.notAPoint(e),e!=null&&(r=e,e=r.x,t=r.y)),typeof e=="string"&&(e=parseFloat(e)),typeof t=="string"&&(t=parseFloat(t)),[e,t]},e.prototype.defaultToZero=function(e,t){return e=isNaN(e)?0:e,t=isNaN(t)?0:t,[e,t]},e.prototype.isPoint=function(t){return e.isPoint(t)},e.prototype.isFloat=function(t){return e.isFloat(t)},e.prototype.notAPoint=function(e){throw new Error(""+e+" isn't a point-like object")},e.prototype.noPoint=function(e){throw new Error(""+e+" was called without arguments")},e.prototype.invalidLength=function(e){throw new Error("Invalid length "+e+" provided")},e.prototype.invalidScale=function(e){throw new Error("Invalid scale "+e+" provided")},e.prototype.clone=function(){return new e(this)},e.prototype.toString=function(){return"[object Point("+this.x+","+this.y+")]"},e}(),this.geomjs.Matrix=e,this.geomjs.Point=t}).call(this)